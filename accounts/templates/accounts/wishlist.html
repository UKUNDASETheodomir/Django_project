{% extends "accounts/base.html" %}
{% load static %}

{% block content %}

<style>
    .wishlist-table thead th { 
        background-color: #f7f7f7; 
        border-bottom: 2px solid #ddd;
        font-weight: 600;
        color: #253D4E;
    }
    .wishlist-table tbody td { 
        vertical-align: middle; 
        padding: 15px 10px;
    }
    .wishlist-table img { 
        width: 80px; 
        height: 80px; 
        object-fit: contain; 
        border: 1px solid #eee;
        border-radius: 8px;
    }
    .status-in-stock { color: #3BB77E; font-weight: 600; }
    .status-out-stock { color: #ff0000; font-weight: 600; }
    .btn-remove { 
        background-color: #fce8e8; 
        color: #ff0000; 
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        transition: background-color 0.2s;
    }
    .btn-remove:hover { background-color: #f9dcdc; }
    .btn-cart {
        background-color: #3BB77E;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        text-decoration: none;
        transition: background-color 0.2s;
    }
    .btn-cart:hover { background-color: #319e68; }
</style>

<div class="container my-5">
    <h1 class="fw-bold mb-5 text-center">My Wishlist ({{ wishlist_count }})</h1>

    {% if items %}
        <div class="table-responsive">
            <table class="table wishlist-table table-hover align-middle">
                <thead>
                    <tr>
                        <th scope="col">Product</th>
                        <th scope="col">Price</th>
                        <th scope="col">Stock Status</th>
                        <th scope="col">Action</th>
                        <th scope="col">Remove</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <td class="d-flex align-items-center">
                            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="me-3">
                            <a href="{% url 'product_detail' item.product.id %}" class="text-dark fw-bold text-decoration-none">{{ item.product.name }}</a>
                        </td>
                        <td>
                            <span class="fs-5 fw-bold text-success">${{ item.product.price }}</span>
                        </td>
                        <td>
                            {% if item.product.stock > 0 and item.product.status == 'available' %}
                                <span class="status-in-stock">In Stock</span>
                            {% else %}
                                <span class="status-out-stock">Out of Stock</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if item.product.stock > 0 and item.product.status == 'available' %}
                                <a href="{% url 'add_to_cart' item.product.id %}" class="btn-cart">
                                    <i class="bi bi-cart3 me-1"></i> Add to Cart
                                </a>
                            {% else %}
                                <button class="btn btn-secondary" disabled>Notify Me</button>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'remove_from_wishlist' item.product.id %}" class="btn-remove">
                                <i class="bi bi-x-lg"></i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-info text-center" role="alert">
            <i class="bi bi-heart-fill me-2"></i> Your wishlist is currently empty.
        </div>
    {% endif %}
</div>

{% endblock %}